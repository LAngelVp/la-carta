<div class="gallery-container w-full max-w-7xl mx-auto px-4">
  
  <!-- GalerÃ­a Principal -->
  @if (!gridLayout) {
    <!-- Slider Layout -->
    <div class="relative rounded-2xl overflow-hidden shadow-2xl">
      <swiper-container #swiperContainer class="w-full h-96 md:h-[300px] lg:h-[500px]">
        @for (image of images; track $index; let i = $index) {
          <swiper-slide 
            class="flex items-center justify-center bg-black cursor-pointer"
            (click)="onImageClick(image, i)">
            <img 
              [src]="image.src" 
              [alt]="image.alt || 'Gallery image'"
              class="w-full h-full object-cover transition-transform duration-500 hover:scale-105">
          </swiper-slide>
        }
      </swiper-container>
    </div>

    <!-- Thumbnails -->
    @if (showThumbnails && images.length > 1) {
      <div class="mt-4 flex justify-center space-x-2">
        @for (image of images; track $index; let i = $index) {
          <div 
            (click)="onThumbnailClick(i)"
            class="w-16 h-16 md:w-20 md:h-20 rounded-lg overflow-hidden cursor-pointer border-2 border-transparent hover:border-blue-500 transition-all duration-200">
            <img 
              [src]="image.thumbnail || image.src" 
              [alt]="image.alt || 'Thumbnail'"
              class="w-full h-full object-cover">
          </div>
        }
      </div>
    }
  } @else {
    <!-- Grid Layout -->
    <div class="grid gap-4 {{ gridColumnsClass }}">
      @for (image of images; track $index; let i = $index) {
        <div 
          (click)="onImageClick(image, i)"
          class="relative group cursor-pointer rounded-xl overflow-hidden shadow-lg transition-all duration-300 hover:shadow-2xl hover:scale-105">
          <img 
            [src]="image.src" 
            [alt]="image.alt || 'Gallery image'"
            class="w-full h-48 md:h-64 object-cover transition-transform duration-500 group-hover:scale-110">
          <div class="absolute inset-0 bg-black bg-opacity-0 group-hover:bg-opacity-30 transition-all duration-300 flex items-center justify-center">
            <svg class="w-12 h-12 text-white opacity-0 group-hover:opacity-100 transform scale-75 group-hover:scale-100 transition-all duration-300" 
                 fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0zM10 7v4m0 4v-4m4 0h-4"/>
            </svg>
          </div>
        </div>
      }
    </div>
  }

  <!-- Lightbox Modal -->
  @if (isLightboxOpen) {
    <div class="fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-95 backdrop-blur-sm">
      
      <!-- Close Button -->
      <button 
        (click)="closeLightbox()"
        class="absolute top-6 right-6 z-10 text-white hover:text-gray-300 transition-colors duration-200">
        <svg class="w-8 h-8" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/>
        </svg>
      </button>

      <!-- Navigation Arrows -->
      <button 
        (click)="prevImage()"
        class="absolute left-6 z-10 text-white hover:text-gray-300 transition-colors duration-200 hidden md:block">
        <svg class="w-10 h-10" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"/>
        </svg>
      </button>

      <button 
        (click)="nextImage()"
        class="absolute right-6 z-10 text-white hover:text-gray-300 transition-colors duration-200 hidden md:block">
        <svg class="w-10 h-10" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"/>
        </svg>
      </button>

      <!-- Lightbox Content -->
      <div class="relative w-full h-full max-w-6xl max-h-[90vh] flex items-center justify-center p-4">
        <swiper-container #lightboxSwiper class="w-full h-full">
          @for (image of images; track $index) {
            <swiper-slide class="flex items-center justify-center">
              <img 
                [src]="image.src" 
                [alt]="image.alt || 'Gallery image'"
                class="max-w-full max-h-full object-contain rounded-lg">
            </swiper-slide>
          }
        </swiper-container>
      </div>

      <!-- Image Counter -->
      <div class="absolute bottom-6 left-1/2 transform -translate-x-1/2 text-white text-lg font-medium bg-black bg-opacity-50 px-4 py-2 rounded-full">
        {{ currentIndex + 1 }} / {{ images.length }}
      </div>
    </div>
  }
</div>